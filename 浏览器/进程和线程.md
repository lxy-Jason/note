### 进程

程序的一次执行过程,是一个动态概念,是程序在执行过程中分配和管理资源的基本单位

### 线程

CPU调度的和分派的基本单位,它可与同属一个进程的其他线程共享进程所拥有的全部资源

### 理解

进程可以理解成正在执行的应用程序

线程可以理解成我们应用程序中的代码执行器

所以线程是跑在进程中的,一个进程可能有多个线程,但一个线程只能隶属于一个进程

### 浏览器进程(chrome)

主要有四个:

- 浏览器进程(Browser Process):负责浏览器tab页的前进,后退,地址栏工作和处理浏览器的一些不可见的底层操作,比如网络请求和文件访问
- 渲染进程(Renderer Process):负责一个Tab内显示相关的工作,也称渲染引擎
- 插件进程(Plugin Rrocess):负责控制网页使用到的插件
- GPU进程(GPU Process):负责处理整个应用程序的GPU任务

#### 四个进程之间的关系

当我们在浏览器的地址栏中输入URL,这个时候浏览器进程会向这个URL发送请求,获取到返回的html内容后

将html交给渲染进程解析html,解析中碰到需要请求网络资源又返回来交给浏览器进程加载

同时通知浏览器进程需要插件进程加载插件资源,执行插件代码

解析完毕之后,渲染进程计算得到图像帧,并将这些图像帧交给GPU进程

GPU进程将其转成图像显示在屏幕上

### 多进程架构的好处

#### 1.更高的容错率

因为浏览器访问的页面来自不同的开发者,因为各种原因出现各种bug,而其中一些bug可能会导致渲染引擎直接崩溃

多进程的架构使得每个渲染引擎运行在各自的进程中,相互之间不受影响

当其中一个崩溃之后不会影响到其他页面

#### 2.更高的安全性和沙盒性

同样是因为Internet中存在很多不可信或者说恶意的代码

这些恶意的代码可能会利用一些漏洞窃取信息或者安装恶意软件

浏览器对不同进程限制不同的权限,并提供沙盒运行环境,使其更安全可靠

#### 3.更高的响应速度

单进程的架构各个任务相互竞争抢夺CPU资源,会影响浏览器响应速度

而多进程架构就避免了这个问题

### 浏览器进程中的线程

- UI thread : 控制浏览器上的按钮及输入框
- network thread : 处理网络请求,获取数据
- storage thread : 控制文件等访问

### 渲染进程中的线程

- GUI渲染线程

> 负责渲染浏览器页面,解析HTML,css,构建DOM树和Render树,布局和绘制
>
> 当页面repaint或者reflow时也会执行

- JS引擎线程

> 也称为JS内核,负责解析js代码,执行js代码
>
> GUI线程和Js引擎线程互斥,所以js执行会阻塞HTML的解析和渲染

- 事件触发线程

> 当事件被触发时该线程会把事件添加到待处理队列的对尾,等待JS引擎处理
>
> 这些事件可以是浏览器事件(鼠标点击),也可以是异步任务(AJAX请求)

- 定时器线程

> 就是setTimeout和setInterval计时所在线程
>
> JS执行到定时器时,在这个线程中进行计时,计时结束,将对应的回调函数放入事件队列中
>
> 注意,W3C标准中,规定setTimeout低于4ms的时间间隔算为4ms

- 异步http请求线程

> 当XMLHttpRequest执行时,新开一个线程,监听其状态改变,如果设置了对应的状态改变回调函数
>
> 就会把这个回调放入事件队列中等待JS引擎处理

