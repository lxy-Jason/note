### 问题现象

不能稳定复现的显示bug

在有数据的情况下,显示了无数据的提示

接口请求了两次,第一次用的参数默认值,拿不到数据

第二次才能拿到数据

### 实现方式

路由跳转拿到企业id

将这个id保存在vuex中

在vuex的actions中调用接口请求数据,保存在vuex中

在组件中使用拿到的数据

通过watch监听数据的修改

有数据时渲染数据,没有数据时显示无数据的提示

这整个流程下来是没有什么问题的

但应该是项目的体量大了,出现了这种数据改变但更新不及时的情况

### 问题分析

解决不了渲染不及时的问题,那就解决一开始没数据的问题

从而避免一开始没数据,渲染无数据提示的情况

仔细查看两次调用接口的的位置

一次是在父组件页面加载时从路由中拿到id之后,调用一次获取数据

一次是在子组件中切换时间时,调用接口获取对应时间段的数据

**问题就在这里,这里监听选择器值的改变,使用了immediate**

所以在组件加载时会执行一次

这就是页面加载时会调两次接口的原因

watch如果设置了`immediate:true`

**第一次执行是在created之前,而父组件中是在mounted中更新企业id**

所以每次页面加载,先是watch中都会调用一次参数为空的接口,没有数据,显示无数据提示

等到mounted执行时,有参数才能拿到数据去更新页面

这里有几率出现无数据提示没有隐藏的情况,这应该是渲染上的问题

### 解决方法

watch的immediate设置成false

这里确实不需要watch立即执行一次

以后注意这方面的使用

